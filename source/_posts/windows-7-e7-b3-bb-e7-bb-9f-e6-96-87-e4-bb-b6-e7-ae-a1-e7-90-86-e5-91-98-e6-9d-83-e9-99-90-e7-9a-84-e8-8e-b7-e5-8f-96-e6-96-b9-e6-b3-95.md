---
title: windows 7系统文件管理员权限的获取方法
tags:
  - win7
  - 权限
url: 832.html
id: 832
categories:
  - 软件物语
date: 2011-10-05 04:38:54
---

对于这一问题，如果去百度的话，得到的答案多是如下：

新建个记事本，命名为  XXX.reg  编辑写入如下内容

\[ccein\_html\] Windows Registry Editor Version 5.00 \[HKEY\_CLASSES\_ROOT\\*\\shell\\runas\] @="管理员取得所有权" "NoWorkingDirectory"="" \[HKEY\_CLASSES\_ROOT\\*\\shell\\runas\\command\] @="cmd.exe /c takeown /f \\"%1\\" && icacls \\"%1\\" /grant administrators:F" "IsolatedCommand"="cmd.exe /c takeown /f \\"%1\\" && icacls \\"%1\\" /grant administrators:F" \[HKEY\_CLASSES\_ROOT\\exefile\\shell\\runas2\] @="管理员取得所有权" "NoWorkingDirectory"="" \[HKEY\_CLASSES\_ROOT\\exefile\\shell\\runas2\\command\] @="cmd.exe /c takeown /f \\"%1\\" && icacls \\"%1\\" /grant administrators:F" "IsolatedCommand"="cmd.exe /c takeown /f \\"%1\\" && icacls \\"%1\\" /grant administrators:F" \[HKEY\_CLASSES\_ROOT\\Directory\\shell\\runas\] @="管理员取得所有权" "NoWorkingDirectory"="" \[HKEY\_CLASSES\_ROOT\\Directory\\shell\\runas\\command\] @="cmd.exe /c takeown /f \\"%1\\" /r /d y && icacls \\"%1\\" /grant administrators:F /t" "IsolatedCommand"="cmd.exe /c takeown /f \\"%1\\" /r /d y && icacls \\"%1\\" /grant administrators:F /t" \[/ccein\_html\]

这样，我们就可以在右键菜单成功插入一项功能“取得管理员权限”

如图：

![](http://ccc5.cc/wp-content/uploads/image/1.png)

但这貌似只支持文件夹，EXE,DLL,OCX等之类的文件

上次我搞系统美化的时候，在system32下面有一个appwiz.cpl文件，右键时就不出现“取得管理员权限”

如图：

![](http://ccc5.cc/wp-content/uploads/image/2.png)

我也没去测试，上面那个注册表文件到底包含多少支持的文件格式···（关键是那里面的命令没看懂），至少今天算是碰到一个了，那么如何解决呢？难道非得到PE模式下替换/修改？

搞了半天找到个解决的办法：

在指定的文件上右键-----属性

依次打开文件夹属性选项卡，按顺序单击：安全 》 高级 》所有者 》　编辑，选中Administrators用户组（或者你的用户所在的组）。确定并关闭属性对话框即获取该文件的所有权。如图：

![](http://ccc5.cc/wp-content/uploads/image/3.png)

再次单击鼠标右键打开属性对话框，依次单击：安全 》 高级，选中下面的两个勾，然后点击编辑，选中并双击Administrators（或者你的用户所在的组　>;　单击"完全控制"，按确定依次退出即可

OK，至此你已经拥有这个文件的管理权限，可以进行下一步的修改和替换了。