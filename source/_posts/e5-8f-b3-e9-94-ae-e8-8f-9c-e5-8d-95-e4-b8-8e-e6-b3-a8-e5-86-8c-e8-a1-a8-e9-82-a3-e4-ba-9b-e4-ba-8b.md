---
title: 右键菜单与注册表那些事
tags:
  - 右键菜单
  - 注册表
url: 1379.html
id: 1379
categories:
  - 编程随想
date: 2012-05-08 18:26:54
---

在注册表中修改右键菜单，修改前要备份注册表，建议用第三方工具修改右键菜单，在右键菜单中不宜添加过多的菜单。

一、添加右键菜单

例1、为所有文件添加“用记事本打开”右键菜单  
①展开 HKEY\_CLASSES\_ROOT\\*\\shell，右击“shell”键，选择“新建/项”，输入名称为“命令”;

![在注册表中修改右键菜单讲课提纲 - 火力光波 - 火力光波的博客](http://i.6.cn/cvbnm/d3/cc/30/6dbdfc1b072efec43c0f3f1acacab82b.jpg)

②在右栏中右击“默认”，选择“修改”，输入值字符串“用记事本打开”，按确定；

![在注册表中修改右键菜单讲课提纲 - 火力光波 - 火力光波的博客](http://i.6.cn/cvbnm/25/e2/e3/06aef3f39dbc90d641d336421e4576c3.jpg) 

![在注册表中修改右键菜单讲课提纲 - 火力光波 - 火力光波的博客](http://i.6.cn/cvbnm/3a/89/6a/7ad5d388e50f414910a307e975446580.jpg)

③在“命令”下面创建一个名称为“command”的子键，输入“默认”值“c:\\windows notepad.exe %1”或“notepad.exe %1”，按确定退出。

![在注册表中修改右键菜单讲课提纲 - 火力光波 - 火力光波的博客](http://i.6.cn/cvbnm/d5/27/27/9821b7e82700f4fdbb33d6df034a8d39.jpg)

![在注册表中修改右键菜单讲课提纲 - 火力光波 - 火力光波的博客](http://i.6.cn/cvbnm/55/a4/a3/782babd882ac6918bc80738f60644ed5.jpg) 

添加“用记事本打开”后的右键菜单：

![在注册表中修改右键菜单讲课提纲 - 火力光波 - 火力光波的博客](http://i.6.cn/cvbnm/b0/70/a0/52b94483c3a631db5e3483c704b6f00b.jpg)

删除“用记事本打开”右键菜单，只需将“命令”子键删除即可。

![在注册表中修改右键菜单讲课提纲 - 火力光波 - 火力光波的博客](http://i.6.cn/cvbnm/ae/41/83/25599c0f94ca9a98ffa07ea73bb179ad.jpg)

例2、为所有文件夹添加“注册表”右键菜单  
①展开 HKEY\_CLASSES\_ROOT\\Directory\\shell   
    在其下新建“regedit\\command”    commmand键值：regedit.exe    (不影响驱动器)  
②展开 HKEY\_CLASSES\_ROOT\\folder\\shell   
    在其下新建“regedit\\command”    commmand键值：regedit.exe     (影响驱动器)

例3、为所有文件与文件夹添加“新浪UC蝴蝶版”右键菜单  
展开 HKEY\_CLASSES\_ROOT\\AllFilesystemObjects  
在其下新建“shell\\UC \\command”    commmand键值：新浪UC蝴蝶版绝对路径 (不影响驱动器)

例4、为所有文件与文件夹添加“复制到文件夹”右键菜单  
展开 HKEY\_CLASSES\_ROOT\\AllFilesystemObjects\\shellex\\ContextMenuHandlers\   
在其下新建“命令\\command”  
Copy To   复制到文件夹   键值：{C2FBB630-2971-11d1-A18C-00C04FD75D13}  
Move To   移动到文件夹   键值：{C2FBB631-2971-11D1-A18C-00C04FD75D13}  
Send To   发送到             键值：{7BA4C740-9E81-11CF-99D3-00AA004AE837}

例5、添加“我的电脑”右键菜单  
展开 HKEY\_CLASSES\_ROOT\\CLSID\\{20D04fe0-3AEA-1069-A2D8-08002B30309D}\\shell  
在其下新建“我的电脑\\command”      commmand键值：我的电脑绝对路径 

例6、添加桌面空白处“注册表”右键菜单  
展开 HKEY\_CLASSES\_ROOT\\Directory\\Background  
在其下新建“shell\\regedit\\command”      commmand键值：regedit.exe

例7、添加桌面空白处“新建.red”右键菜单  
展开 HKEY\_CLASSES\_ROOT\\.red  
在其下新建 ShellNew，再新建字符串filename，键值为空，按F5刷新。  
如将“ShellNew”改为“ShellNewOld”子键，则不显示菜单。

例8、删除“IE浏览器”右键菜单  
展开 HKEY\_CURRENT\_USER\\Software\\Microsoft\\Internet Explorer\\Menxt  
在其下将子键删除。

二、删除右键菜单

1、自行添加的在shell处删除

2、删除安装的程序菜单，从下面路径中找：

HKEY\_CLASSES\_ROOT\\*\\shellex\\ContextMenuHandlers\              对所有文件  
HKEY\_CLASSES\_ROOT\\Directory\\Background                             对桌面空白处(文件背景)  
HKEY\_CLASSES\_ROOT\\Directory\\shellex\\ContextMenuHandlers\  对所有文件夹  
HKEY\_CLASSES\_ROOT\\folder\\shellex\\ContextMenuHandlers\       对所有文件夹(包括驱动器、回收站)   
HKEY\_CLASSES\_ROOT\\AllFilesystemObjects\\shellex\\ContextMenuHandlers\   对所有文件与文件夹

3、删除“新建”中的程序菜单

①用控制面板卸载软件。  
②在文件夹选项中删除软件残余：选择“文件类型”，右键删除扩展名。  
③将新建 ShellNew 改为 ShellNewOld子键，则不显示菜单。  
④删除特殊文件夹-公文包，删除HKEY\_CLASSES\_ROOT\\Briefcase\\下的ShellNew。

三、菜单故障处理

1、丢失“发送到”  
路径：KEY\_CLASSES\_ROOT\\AllFilesystemObjects\\shellex\\ContextMenuHandlers\\Send To   
2、丢失“新建”菜单  
路径：KEY\_CLASSES\_ROOT\\Directory\\Background\\shellex\\ContextMenuHandlers\\New  
解决方法：导入注册表或运行添加命令